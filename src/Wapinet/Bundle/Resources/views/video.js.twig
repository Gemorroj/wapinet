{% set format %}{% spaceless %}
    {% if file.isM4v or file.is3gp %}
        m4v
    {% elseif file.isOgv %}
        ogv
    {% elseif file.isWebmv or file.isAvi %}
        webmv
    {% elseif file.isFlv %}
        flv
    {% endif %}
{% endspaceless %}{% endset %}

{% set video %}{% spaceless %}
    {% if file.is3gp %}
        {{ vich_uploader_asset(file, 'file')|wapinet_video_3gp_to_mp4 }}
    {% elseif file.isAvi %}
        {{ vich_uploader_asset(file, 'file')|wapinet_video_avi_to_webm }}
    {% else %}
        {{ vich_uploader_asset(file, 'file') }}
    {% endif %}
{% endspaceless %}{% endset %}

$(document).ready(function(){
    $("#jquery_jplayer_1").jPlayer({
        "ready": function () {
            $(this).jPlayer("setMedia", {
                "{{ format }}": "{{ video }}",
                "poster": "{{ vich_uploader_asset(file, 'file')|wapinet_video_screenshot }}"
            });
        },
        "supplied": "{{ format }}",
        "swfPath": "{{ asset('bundles/wapinet/js/jplayer/Jplayer.swf') }}"
    });
});
