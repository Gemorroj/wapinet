{% extends 'WapinetMessageBundle::layout.html.twig' %}

{% block title %}{{ thread.subject }}{% endblock %}

{% block fos_message_content %}
    <ul data-role="listview" data-inset="true">
        {% for message in thread.messages %}
            <li data-role="list-divider">
                <a href="{{ path('wapinet_user_profile', {'username': message.sender.username}) }}">{{ message.sender.username }}</a>
                {{ message.createdAt|wapinet_datetime  }}
            </li>
            <li data-icon="false">
                <span class="comment-avatar">
                    <img src="{{ wapinet_user_get_avatar_url(message.sender) }}" alt="{{ message.sender }}" class="image-preview" />
                    {% if message.sender.isOnline %}
                        <span class="avatar-online"></span>
                    {% endif %}
                </span>

                <div class="long-description">
                    {{ message.body|wapinet_bbcode_parse }}
                </div>
            </li>
        {% endfor %}
    </ul>

    <h3>Ответить</h3>

    {{ form_start(form, {'action': path('fos_message_thread_view', {'threadId': thread.id}), 'method': 'POST'}) }}
        {{ form_widget(form) }}
        <div>
            <input type="submit" value="Отправить" />
        </div>
    {{ form_end(form) }}
{% endblock %}
